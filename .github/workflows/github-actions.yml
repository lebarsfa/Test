on:
    push:
        branches: '**'
        tags: '' # Restrict to blank tags
    pull_request:

jobs:
 # This job may be commented if a new release should not be created...
# deploy:
#    runs-on: ubuntu-latest
#    steps: 
#    - uses: actions/create-release@v1
#      id: create_release
#      env:
#        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#      with:
#        draft: true
#        tag_name: autotagname
#        release_name: autotagname

 jtestlj:
    name: Windows
    runs-on: windows-latest
    steps: 
    - uses: actions/checkout@v2
    - run: |
        (New-Object System.Net.WebClient).DownloadFile("http://www.ensta-bretagne.fr/lebars/Share/windows_extra_tools.zip", "C:\Windows\Temp\windows_extra_tools.zip") 
        7z x C:\Windows\Temp\windows_extra_tools.zip -o"C:\Windows" -y
      shell: pwsh
    - run: |
        rem choco list --localonly
        rem choco install -y vcredist-all
        wget https://github.com/jmalarcon/DotNetVersions/releases/download/v1.0.0/DotNetVersions.zip --no-check-certificate -nv
        unzip -q DotNetVersions.zip
        DotNetVersions.exe & cd. & rem Non-zero exit code...
      shell: cmd
    - run: |
        rem For LabJack
        wget http://www.ensta-bretagne.fr/lebars/Share/LabJack-2019-05-20.zip --no-check-certificate -nv
        7z x LabJack-2019-05-20.zip -o"%SystemDrive%" -y
        regedit /s %SystemDrive%\LabJack-2019-05-20\Certificates.reg
        %SystemDrive%\LabJack-2019-05-20\LabJack-2019-05-20.exe /S
        echo Installing...
        wget http://www.ensta-bretagne.fr/lebars/Share/cmake_extra_tools.zip --no-check-certificate -nv
        7z x cmake_extra_tools.zip -o"%SystemDrive%" -y
        %SystemDrive%\cmake_extra_tools\sleep 60
        TASKKILL /F /IM LVRunTimeEng.exe /T
      shell: cmd
